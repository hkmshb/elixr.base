{% extends "layout.html" %}
{% block content %}
    <div class="header">
        <h1 class="inline">GridIX.Web</h1> &nbsp;&nbsp;<h3 class="inline">Data Import</h3>
    </div>
    <div class="col-xs-5 col-md-5 rm-lpad">
        <form class="upload" method="post" enctype="multipart/form-data">
            <p>Select Excel (.xlsx) file containing data.</p>
            <div class="form-group form-control file-wrap input-sm">
                <input type="file" class="col-md-12 rm-lpad uplfile" name="uplfile" required />
            </div>
            <div class="form-group">
                <button class="btn btn-primary btn-sm import" name="form.submitted">Import Data</button>
                <span class="text-danger import-msg"></span>
            </div>
        </form>
    </div>
{% endblock content %}
{% block script_extra -%}
    <script>
        $(document).ready(function() {
            $('.uplfile').on('change', function() {
                var target_ext = ['.xls', '.xlsx'];
                var fn = $(this).val()
                  , ext = fn.substr(fn.lastIndexOf('.'))
                  , $imsg = $('.import-msg')
                  , $ibtn = $('.btn.import');

                $imsg.text(''); $ibtn.removeAttr('disabled');
                if (fn !== "" && $.inArray(ext, target_ext) === -1) {
                    $imsg.text('Invalid file type selected, .xls, .xlsx expected.');
                    $ibtn.attr('disabled', 'disabled');
                }
            });
        })
    </script>
{% endblock %}
